/**
 * OvsTest - OVS + CSSTS æµ‹è¯•ç•Œé¢
 * 
 * æ¼”ç¤ºï¼š
 * 1. OVS å£°æ˜å¼è¯­æ³•: tag(props) {}
 * 2. CSSTS css {} åŸå­ç±»
 * 3. $ ä¼ªç±»è¯­æ³•
 * 4. view ç»„ä»¶
 * 5. åŸç”Ÿ if/for æ§åˆ¶æµ
 */

import { ref, computed } from 'vue'

// ========== æ ·å¼å®šä¹‰ ==========

const container = css {
  padding40px,
  maxWidth800px,
  marginAuto
}

const title = css {
  colorDodgerblue,
  fontSize24px,
  marginBottom20px
}

const card$hover = css {
  padding20px,
  borderRadius8px,
  backgroundColorWhite,
  marginBottom20px
}

// æŒ‰é’®åŸºç¡€æ ·å¼
const btnBase = css {
  displayInlineFlex,
  alignItemsCenter,
  paddingTop10px,
  paddingBottom10px,
  paddingLeft20px,
  paddingRight20px,
  borderRadius6px,
  cursorPointer,
  fontSize14px,
  borderNone,
  marginRight10px
}

const btnPrimary$hover$active = css { btnBase, backgroundColorDodgerblue, colorWhite }
const btnSuccess$hover$active = css { btnBase, backgroundColorLimegreen, colorWhite }
const btnDanger$hover$active = css { btnBase, backgroundColorCrimson, colorWhite }
const btnDefault$hover$active = css { btnBase, backgroundColorWhite, colorGray, borderWidth1px, borderStyleSolid, borderColorLightgray }

const counter = css { fontSize48px, colorDodgerblue, textAlignCenter, padding20px }
const flexRow = css { displayFlex, alignItemsCenter, gap10px }
const input$focus = css { padding10px, borderRadius4px, borderWidth1px, borderStyleSolid, borderColorLightgray, width200px }
const listItem$hover = css { padding12px, borderRadius4px, marginBottom8px, backgroundColorAliceblue, displayFlex, justifyContentSpaceBetween, alignItemsCenter }
const tag = css { paddingTop4px, paddingBottom4px, paddingLeft8px, paddingRight8px, borderRadius4px, fontSize12px }
const tagDone = css { tag, backgroundColorLimegreen, colorWhite }
const tagPending = css { tag, backgroundColorOrange, colorWhite }

// ========== å­ç»„ä»¶ ==========

view CounterDemo(props) {
  const count = ref(0)
  
  div(class = card$hover) {
    h3 { 'ğŸ”¢ è®¡æ•°å™¨' }
    div(class = counter) { count.value }
    div(class = flexRow) {
      button(class = btnPrimary$hover$active, onClick() { console.log('[+1] è¢«ç‚¹å‡», count.value =', count.value); count.value++ }) { '+1' }
      button(class = btnDanger$hover$active, onClick() { console.log('[-1] è¢«ç‚¹å‡», count.value =', count.value); count.value-- }) { '-1' }
      button(class = btnDefault$hover$active, onClick() { console.log('[é‡ç½®] è¢«ç‚¹å‡»'); count.value = 0 }) { 'é‡ç½®' }
    }
  }
}

view TodoDemo(props) {
  const newTodo = ref('')
  const todos = ref([
    { id: 1, text: 'å­¦ä¹  OVS è¯­æ³•', done: true },
    { id: 2, text: 'æŒæ¡ CSSTS æ ·å¼', done: false },
    { id: 3, text: 'æ„å»ºå®Œæ•´åº”ç”¨', done: false }
  ])
  
  function addTodo() {
    console.log('[addTodo] è¢«è°ƒç”¨, newTodo.value =', newTodo.value)
    if (newTodo.value.trim()) {
      console.log('[addTodo] æ·»åŠ æ–°é¡¹ç›®:', newTodo.value)
      todos.value.push({ id: Date.now(), text: newTodo.value, done: false })
      newTodo.value = ''
    } else {
      console.log('[addTodo] å€¼ä¸ºç©ºï¼Œä¸æ·»åŠ ')
    }
  }
  
  div(class = card$hover) {
    h3 { 'ğŸ“ å¾…åŠäº‹é¡¹' }
    
    div(class = flexRow) {
      input(class = input$focus, value = newTodo.value, placeholder = 'è¾“å…¥å¾…åŠ...', onInput(e) { newTodo.value = e.target.value }) {}
      button(class = btnSuccess$hover$active, onClick() { addTodo() }) { 'æ·»åŠ ' }
    }
    
    div(style = 'margin-top: 15px') {
      for (const todo of todos.value) {
        div(class = listItem$hover, key = todo.id) {
          span(style = todo.done ? 'text-decoration: line-through; color: #999' : '') { todo.text }
          div(class = flexRow) {
            if (todo.done) {
              span(class = tagDone) { 'å®Œæˆ' }
            } else {
              span(class = tagPending) { 'å¾…åŠ' }
            }
            button(class = btnDefault$hover$active, onClick() { todo.done = !todo.done }) { todo.done ? 'æ’¤é”€' : 'å®Œæˆ' }
          }
        }
      }
    }
  }
}

// ========== ä¸»ç»„ä»¶ ==========

view OvsTest(props) {
  div(class = container) {
    h1(class = title) { 'ğŸ¨ OVS + CSSTS æµ‹è¯•' }
    
    CounterDemo() {}
    TodoDemo() {}
    
    div(class = card$hover) {
      h3 { 'âœ¨ è¯­æ³•ç‰¹æ€§' }
      ul {
        li { 'å£°æ˜å¼ UI: tag(props) { content }' }
        li { 'åŸç”Ÿæ§åˆ¶æµ: if/for ç›´æ¥ä½¿ç”¨' }
        li { 'view ç»„ä»¶: view Name(props) { }' }
        li { 'css {} åŸå­ç±»: ç±»å‹å®‰å…¨æ ·å¼' }
        li { '$ ä¼ªç±»: hover/active/focus' }
      }
    }
  }
}

export default OvsTest
