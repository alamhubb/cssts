# CssTs

> CSS-in-TSï¼šç¼–è¯‘æ—¶åŸå­ CSS ç±»ç®¡ç†ç³»ç»Ÿ

CssTs æ˜¯ä¸€ä¸ªç±»å‹å®‰å…¨çš„åŸå­ CSS è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡ TypeScript æä¾›å®Œæ•´çš„ IDE æ”¯æŒï¼Œåœ¨ç¼–è¯‘æ—¶ç”Ÿæˆä¼˜åŒ–çš„ CSSã€‚

## ç‰¹æ€§

- ğŸ¯ **ç±»å‹å®‰å…¨** - å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰ï¼ŒIDE ä»£ç è¡¥å…¨
- ğŸš€ **ç¼–è¯‘æ—¶ä¼˜åŒ–** - CSS åœ¨æ„å»ºæ—¶æŒ‰éœ€ç”Ÿæˆï¼Œé›¶è¿è¡Œæ—¶å¼€é”€
- ğŸ“¦ **é›¶ä¾èµ–è¿è¡Œæ—¶** - runtime åŒ…æ— ä»»ä½•ä¾èµ–ï¼Œä½“ç§¯æœ€å°
- ğŸ¨ **`$` ä¼ªç±»è¯­æ³•** - é€šè¿‡å˜é‡åå£°æ˜ä¼ªç±»ï¼ˆåŒç¾å…ƒç¬¦å· `$`ï¼‰
- ğŸ§© **ç®€æ´æ•°æ®ç»“æ„** - ç»Ÿä¸€çš„ `Set<string>` å­˜å‚¨ï¼ŒæŒ‰éœ€è§£æ
- ğŸ’¡ **å…¨å±€å¸¸é‡æç¤º** - åŸå­ç±»å£°æ˜ä¸ºå…¨å±€å¸¸é‡ï¼ŒIDE è‡ªåŠ¨è¡¥å…¨

## ç±»å‹ç³»ç»Ÿè®¾è®¡

### æ ¸å¿ƒé—®é¢˜ï¼šIDE æç¤ºä¸ç¼–è¯‘è½¬æ¢çš„ç»Ÿä¸€

ç”¨æˆ·åœ¨ `css { }` ä¸­è¾“å…¥æ—¶ï¼š
1. è¾“å…¥ `d` â†’ IDE åº”æç¤º `displayFlex`, `displayBlock` ç­‰
2. è¾“å…¥å®Œæˆ `displayFlex` â†’ ç¼–è¯‘å™¨è½¬æ¢ä¸º `csstsAtom.displayFlex`

### è§£å†³æ–¹æ¡ˆï¼šå…¨å±€å¸¸é‡å£°æ˜

Vite æ’ä»¶å¯åŠ¨æ—¶è‡ªåŠ¨ç”Ÿæˆ `.d.ts` æ–‡ä»¶ï¼Œå°†æ¯ä¸ªåŸå­ç±»å£°æ˜ä¸ºå…¨å±€å¸¸é‡ï¼š

```typescript
// node_modules/@types/cssts/index.d.tsï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
declare const displayFlex: { 'display_flex': true };
declare const displayBlock: { 'display_block': true };
declare const paddingTop16px: { 'padding-top_16px': true };
// ... æ‰€æœ‰åŸå­ç±»
```

**åªéœ€è¦è¿™ä¸€ä¸ªæ–‡ä»¶**ï¼Œä¸éœ€è¦å…¶ä»–ç±»å‹å£°æ˜ï¼š
- âŒ `CsstsAtoms` æ¥å£ - ç”¨æˆ·ä¸ç›´æ¥ä½¿ç”¨
- âŒ `declare module 'virtual:csstsAtom'` - è™šæ‹Ÿæ¨¡å—è¿è¡Œæ—¶ç”± Vite æä¾›

**è¿™æ ·è®¾è®¡çš„å¥½å¤„ï¼š**

1. **IDE è‡ªåŠ¨è¡¥å…¨** - ç”¨æˆ·åœ¨ `css { }` ä¸­è¾“å…¥æ—¶ï¼ŒIDE ä¼šæç¤ºæ‰€æœ‰å·²å£°æ˜çš„å…¨å±€å¸¸é‡
2. **ç±»å‹å®‰å…¨** - å¦‚æœç”¨æˆ·å†™äº†ä¸å­˜åœ¨çš„åŸå­ç±»åï¼ŒIDE ä¸ä¼šæç¤ºï¼Œç”¨æˆ·ç«‹å³çŸ¥é“è¿™ä¸æ˜¯æœ‰æ•ˆçš„åŸå­ç±»
3. **ç¼–è¯‘æ—¶éªŒè¯** - ç¼–è¯‘å™¨å¯ä»¥é€šè¿‡æ£€æŸ¥æ ‡è¯†ç¬¦æ˜¯å¦åŒ¹é…å·²çŸ¥åŸå­ç±»æ¥å†³å®šæ˜¯å¦è½¬æ¢
4. **ç»Ÿä¸€çš„æ•°æ®æº** - IDE æç¤ºå’Œç¼–è¯‘è½¬æ¢ä½¿ç”¨åŒä¸€ä»½ç±»å‹å®šä¹‰ï¼Œä¿è¯ä¸€è‡´æ€§

**å·¥ä½œæµç¨‹ï¼š**

```
ç”¨æˆ·è¾“å…¥ displayFlex
    â†“
IDE è¯†åˆ«ä¸ºå…¨å±€å¸¸é‡ï¼Œæä¾›è¡¥å…¨å’Œç±»å‹æ£€æŸ¥
    â†“
ç¼–è¯‘å™¨è¯†åˆ«ä¸ºåŸå­ç±»åï¼Œè½¬æ¢ä¸º csstsAtom.displayFlex
    â†“
è¿è¡Œæ—¶ä»è™šæ‹Ÿæ¨¡å—è·å– { 'display_flex': true }
```

## âš ï¸ é‡è¦ï¼šä¼ªç±»åˆ†éš”ç¬¦æ˜¯åŒç¾å…ƒç¬¦å· `$`

**ä¼ªç±»è¯­æ³•ä½¿ç”¨åŒç¾å…ƒç¬¦å· `$`ï¼Œä¸æ˜¯å•ç¾å…ƒç¬¦å·ï¼**

```typescript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨åŒç¾å…ƒç¬¦å· $
const primary$hover$active = css { backgroundColorBlue }

// âŒ é”™è¯¯ï¼šä½¿ç”¨å•ç¾å…ƒç¬¦å· $ï¼ˆä¼ªç±»ä¸ä¼šç”Ÿæ•ˆï¼ï¼‰
const primary$hover$active = css { backgroundColorBlue }
```

## åŒ…ç»“æ„

```
cssts/
â”œâ”€â”€ cssts-compiler    # ç¼–è¯‘å™¨ï¼šè§£æã€è½¬æ¢ã€ç”Ÿæˆ
â”œâ”€â”€ cssts-runtime     # è¿è¡Œæ—¶ï¼š$clsã€replaceã€åˆ†éš”ç¬¦é…ç½®ï¼ˆåŒ…åæ˜¯ cssts-tsï¼‰
â””â”€â”€ vite-plugin-cssts # Vite æ’ä»¶
```

## å¿«é€Ÿå¼€å§‹

### å®‰è£…

```bash
npm install cssts-ts vite-plugin-cssts -D
```

### é…ç½® Vite

```typescript
// vite.config.ts
import { defineConfig } from 'vite'
import cssTsPlugin from 'vite-plugin-cssts'

export default defineConfig({
  plugins: [
    cssTsPlugin({
      pseudoUtils: {
        hover: { opacity: '0.9' },
        active: { opacity: '0.6' }
      }
    }),
  ],
})
```


### ä½¿ç”¨

#### æ”¯æŒçš„æ–‡ä»¶ç±»å‹

| æ–‡ä»¶ç±»å‹ | æ”¯æŒ css {} è¯­æ³• |
|---------|-----------------|
| `.cssts` æ–‡ä»¶ | âœ… æ”¯æŒ |
| `.vue` æ–‡ä»¶ `<script lang="cssts">` | âœ… æ”¯æŒ |
| `.ts` æ–‡ä»¶ | âŒ ä¸æ”¯æŒ |
| `.vue` æ–‡ä»¶ `<script lang="ts">` | âŒ ä¸æ”¯æŒ |

#### æ–¹å¼ä¸€ï¼š.cssts æ–‡ä»¶

```typescript
// Button.cssts

// æ™®é€šæ ·å¼
const buttonStyle = css { displayFlex, padding16px, cursorPointer }

// å¸¦ä¼ªç±»çš„æ ·å¼ï¼ˆä½¿ç”¨ $ åŒç¾å…ƒç¬¦å·ï¼‰
const clickable$hover$active = css { cursorPointer, displayFlex }

// å¯¼å‡ºä½¿ç”¨
export { buttonStyle, clickable$hover$active }
```

#### æ–¹å¼äºŒï¼šVue æ–‡ä»¶ä¸­ä½¿ç”¨ `<script lang="cssts">`

```vue
<!-- Button.vue -->
<template>
  <button :class="buttonStyle">ç‚¹å‡»æˆ‘</button>
</template>

<script setup lang="cssts">
// åœ¨ <script lang="cssts"> ä¸­å¯ä»¥ä½¿ç”¨ css {} è¯­æ³•
const buttonStyle = css { displayFlex, padding16px, cursorPointer }
</script>
```

> **æ³¨æ„**ï¼šVite æ’ä»¶ä¼šè‡ªåŠ¨å°† `<script lang="cssts">` è½¬æ¢ä¸º `<script lang="ts">`ï¼Œç„¶åäº¤ç»™ Vue ç¼–è¯‘å™¨å¤„ç†ã€‚

#### å¯¼å…¥ .cssts æ–‡ä»¶

```vue
<!-- åœ¨æ™®é€š Vue æ–‡ä»¶ä¸­å¯¼å…¥ .cssts æ–‡ä»¶ -->
<template>
  <button :class="buttonStyle">ç‚¹å‡»æˆ‘</button>
</template>

<script setup>
import { buttonStyle } from './Button.cssts'
</script>
```

## æ ¸å¿ƒè®¾è®¡ï¼šç»Ÿä¸€çš„æ ·å¼å­˜å‚¨

ä½¿ç”¨å•ä¸€çš„ `Set<string>` å­˜å‚¨æ‰€æœ‰æ ·å¼åï¼ŒæŒ‰éœ€è§£æï¼š

```typescript
// å­˜å‚¨
const styles = new Set<string>()
styles.add('displayFlex')                   // æ™®é€šåŸå­ç±»
styles.add('clickable$hover$active')      // å¸¦ä¼ªç±»çš„æ ·å¼ï¼ˆåŒç¾å…ƒç¬¦å· $ï¼‰

// è§£æï¼ˆæŒ‰éœ€ï¼‰
parseStyleName('displayFlex')
// { baseName: 'displayFlex', pseudos: [] }

parseStyleName('clickable$hover$active')
// { baseName: 'clickable', pseudos: ['hover', 'active'] }
```

**ä¼˜ç‚¹**ï¼š
- æ•°æ®ç»“æ„ç®€å•
- ä¸å­˜å‚¨å†—ä½™æ•°æ®
- æŒ‰éœ€è§£æï¼Œæ›´çµæ´»

## æ ¸å¿ƒæ¦‚å¿µ

### åŸå­ç±»ï¼ˆAtomï¼‰

å•ä¸ª CSS å±æ€§çš„ç±»ï¼š

```typescript
displayFlex      // â†’ .display_flex { display: flex; }
padding16px      // â†’ .padding_16px { padding: 16px; }
colorRed         // â†’ .color_red { color: red; }
```

### ç»„åˆæ ·å¼ï¼ˆGroupUtilï¼‰

å¤šä¸ªåŸå­ç±»çš„ç»„åˆï¼š

```typescript
const buttonStyle = css { displayFlex, padding16px, cursorPointer }
// è¿è¡Œæ—¶ï¼š{ 'display_flex': true, 'padding_16px': true, 'cursor_pointer': true }
```

### $ ä¼ªç±»è¯­æ³•

é€šè¿‡å˜é‡åå£°æ˜ä¼ªç±»ï¼ˆä½¿ç”¨ `$` åŒç¾å…ƒç¬¦å·åˆ†éš”ï¼‰ï¼š

```typescript
// å˜é‡åæ ¼å¼ï¼š{baseName}${pseudo1}${pseudo2}...
const clickable$hover$active = css { cursorPointer }

// è§£æç»“æœ
parseStyleName('clickable$hover$active')
// { baseName: 'clickable', pseudos: ['hover', 'active'] }

// ç”Ÿæˆçš„ CSSï¼š
// .cursor_pointer { cursor: pointer; }     â† åŸå­ç±»
// .clickable:hover { opacity: 0.9; }       â† ä¼ªç±»ï¼ˆæ¥è‡ªé…ç½®ï¼‰
// .clickable:active { opacity: 0.6; }      â† ä¼ªç±»ï¼ˆæ¥è‡ªé…ç½®ï¼‰
```

ä¼ªç±»çš„ CSS å±æ€§æ¥è‡ª vite é…ç½®ï¼Œä¸æ˜¯æ¥è‡ª `css { }` å†…å®¹ã€‚

## å€¼è½¬æ¢è§„åˆ™

| è½¬ä¹‰ç¬¦ | å«ä¹‰ | ç¤ºä¾‹ |
|--------|------|------|
| `p` | `.` å°æ•°ç‚¹ | `opacity0p9` â†’ `0.9` |
| `pct` | `%` ç™¾åˆ†å· | `width50pct` â†’ `50%` |
| `s` | `/` æ–œæ  | `aspectRatio16s9` â†’ `16/9` |
| `N` | `-` è´Ÿæ•° | `zIndexN1` â†’ `-1` |

## æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  .cssts æ–‡ä»¶ / <script lang="cssts">                        â”‚
â”‚  const style = css { displayFlex, padding16px }             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Vite æ’ä»¶å±‚                                                 â”‚
â”‚  â€¢ vite-plugin-cssts: å¤„ç† .cssts æ–‡ä»¶å’Œ <script lang="cssts">â”‚
â”‚  â€¢ å…±äº« globalStyles: Set<string> æ”¶é›†æ‰€æœ‰æ ·å¼               â”‚
â”‚  â€¢ ç”Ÿæˆè™šæ‹Ÿæ¨¡å—å’Œç±»å‹å®šä¹‰æ–‡ä»¶                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¼–è¯‘å™¨å±‚                                                    â”‚
â”‚  â€¢ cssts-compiler: è§£æ css { } è¯­æ³•                        â”‚
â”‚  â€¢ è½¬æ¢ä¸º cssts.$cls(csstsAtom.xxx)                         â”‚
â”‚  â€¢ æŒ‰éœ€è§£ææ ·å¼åï¼Œç”Ÿæˆ CSS                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¿è¡Œæ—¶å±‚                                                    â”‚
â”‚  â€¢ cssts-tsï¼ˆåŒ…åï¼‰: $cls()ã€replace()ã€CSSTS_CONFIG         â”‚
â”‚  â€¢ é›¶ä¾èµ–ï¼Œåªåšå¯¹è±¡æ“ä½œ                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¾“å‡º                                                       â”‚
â”‚  â€¢ JS: cssts.$cls(csstsAtom.displayFlex, ...)               â”‚
â”‚  â€¢ CSS: .display_flex { display: flex; }                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

> è¯¦ç»†æ¶æ„è¯´æ˜è¯·å‚è€ƒ [ARCHITECTURE.md](../ARCHITECTURE.md)

## åˆ†éš”ç¬¦é…ç½®

æ‰€æœ‰åˆ†éš”ç¬¦ç»Ÿä¸€åœ¨ `cssts-ts` ä¸­é…ç½®ï¼Œcompiler å’Œ runtime å…±ç”¨ï¼š

```typescript
import { CSSTS_CONFIG } from 'cssts-ts'

CSSTS_CONFIG.SEPARATOR        // '_'    - ç±»ååˆ†éš”ç¬¦ï¼šproperty_value
CSSTS_CONFIG.PSEUDO_SEPARATOR // '$'   - ä¼ªç±»åˆ†éš”ç¬¦ï¼šbaseName$pseudoï¼ˆåŒç¾å…ƒç¬¦å·ï¼‰
```

## License

MIT
